// Generated by CoffeeScript 1.4.0
(function() {
  var checkUser, checkuserHandler, showCheckUserAlert, usernameInputChanged;

  checkUser = function() {
    var username;
    $('#divAlertsContainer').children().hide();
    $('#btnUsernameCheck').button('loading');
    username = $('#id_username').val();
    return $.ajax("/api/user/" + username + "/?format=json", {
      success: checkuserHandler
    });
  };

  checkuserHandler = function(data, status, xhr) {
    $('#btnUsernameCheck').button('reset');
    return showCheckUserAlert(data.exists);
  };

  showCheckUserAlert = function(userExists) {
    var alertbox, control;
    if (userExists) {
      alertbox = $('#spAlertUserExists');
      $('#id_username').parent().addClass('has-success');
    } else {
      control = $('#spAlertUserNotExists');
      $('#id_username').parent().addClass('has-error');
    }
    return alertbox.fadeIn(function() {
      var delay,
        _this = this;
      return setTimeout((function() {
        return alertbox.fadeOut();
      }), delay = 1000);
    });
  };

  usernameInputChanged = function() {
    var disabled, val;
    val = $('#id_username').val();
    if (val) {
      disabled = false;
    } else {
      disabled = true;
    }
    $('#btnUsernameCheck').prop('disabled', disabled);
    $('#id_username').parent().removeClass('has-error').removeClass('has-success');
    return $('#divAlertsContainer').children().hide();
  };

  $(document).ready(function() {
    console.log('Document loaded');
    $('#btnUsernameCheck').click(checkUser);
    $('#id_username').on('input', usernameInputChanged);
    $('#divAlertsContainer').children().hide();
    return usernameInputChanged();
  });

}).call(this);
